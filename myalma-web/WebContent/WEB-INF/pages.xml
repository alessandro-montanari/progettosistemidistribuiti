<?xml version="1.0" encoding="UTF-8"?>
<pages xmlns="http://jboss.com/products/seam/pages" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://jboss.com/products/seam/pages http://jboss.com/products/seam/pages-2.2.xsd">
	<!-- <page view-id="*"> <navigation> <rule if-outcome="home"> <redirect 
		view-id="/login.xhtml"/> </rule> </navigation> </page> <page view-id="/login.xhtml"> 
		<navigation from-action="submit"> <rule if="#{userHelper.isUserInRole('professor')}"> 
		<redirect view-id="/restricted/professor/FirstPage.xhtml"/> </rule> </navigation> 
		</page> <page view-id="*"> <navigation> <rule if-outcome="docente"> <redirect 
		view-id="/restricted/professor/InformationCenter.xhtml"> <param name="name" 
		value="Ales"/> </redirect> </rule> </navigation> </page> -->
		
		
	<page view-id="/restricted/professor/TeachingSelect.xhtml">
		<!-- Prendo il parametro teachingId e lo metto nel bean teachingControllerBean -->
		<param name="teachingId" value="#{teachingControllerBean.teachingId}" />
		<navigation from-action="teachingSelectAction">
			<rule>
				<begin-conversation />
				<redirect view-id="/restricted/professor/TeachingExplore.xhtml" />
			</rule>
		</navigation>
	</page>
	
	<page view-id="/restricted/professor/TeachingExplore.xhtml">
		<param name="contentId" value="#{contentManager.contentId}" />
		<navigation from-action="cancel">
			<rule>
				<end-conversation />
				<redirect view-id="/restricted/professor/TeachingSelect.xhtml" />
			</rule>
		</navigation>
		
		<!-- Questa regola cattura gli eventi di MODIFICA di contenuti (vedi from-action) -->
		<navigation evaluate="#{contentManager.content.contentType}" from-action="modifyContent">
			<rule if-outcome="INFORMATION">
				<begin-conversation nested="true"/>
				<redirect view-id="/restricted/professor/InformationModificationCenter.xhtml" >
					<param name="new" value="false"/>
				</redirect>
			</rule>
			<rule if-outcome="NOTICE">
				<begin-conversation nested="true" />
				<redirect view-id="/restricted/professor/InformationModificationCenter.xhtml" >
					<param name="new" value="false"/>
				</redirect>
			</rule>
			<rule if-outcome="CATEGORY">
				<begin-conversation nested="true" />
				<redirect view-id="/restricted/professor/CategoryModificationCenter.xhtml" >
					<param name="new" value="false"/>
				</redirect>
			</rule>
			<rule if-outcome="MATERIAL">
				<begin-conversation nested="true" />
				<redirect view-id="/restricted/professor/MaterialModificationCenter.xhtml">
					<param name="new" value="false"/>
					<param name="multi" value="false"/>
				</redirect>
			</rule>
		</navigation>
		
		<!-- Questa regola cattura gli eventi di aggiunta di NUOVI contenuti -->
		<navigation evaluate="#{contentManager.content.contentType}">
			<rule if-outcome="INFORMATION">
				<begin-conversation nested="true" />
				<redirect view-id="/restricted/professor/InformationModificationCenter.xhtml">
					<param name="new" value="true"/>
				</redirect>
			</rule>
			<rule if-outcome="NOTICE">
				<begin-conversation nested="true" />
				<redirect view-id="/restricted/professor/InformationModificationCenter.xhtml">
					<param name="new" value="true"/>
				</redirect>
			</rule>
			<rule if-outcome="CATEGORY">
				<begin-conversation nested="true" />
				<redirect view-id="/restricted/professor/CategoryModificationCenter.xhtml">
					<param name="new" value="true"/>
				</redirect>
			</rule>
			<rule if-outcome="MATERIAL">
				<begin-conversation nested="true" />
				<redirect view-id="/restricted/professor/MaterialModificationCenter.xhtml">
					<param name="new" value="true"/>
					<param name="multi" value="true"/>
				</redirect>
			</rule>
		</navigation>
	</page>
	
	<!-- Questa regola cattura gli eventi che provengono dalle pagine di modifica, cosÃ¬ non ripeto le regole (ci deve essere asterisco) -->
	<page view-id="*">
		<navigation from-action="cancel">
			<end-conversation />
			<redirect view-id="/restricted/professor/TeachingExplore.xhtml">
				<message>Modifiche annullate</message>
			</redirect>
		</navigation>
		
		<!-- Qui potrei usare anche l'action che effettivamente uso in Salva -->
		<navigation from-action="#{contentManager.save}">
			<end-conversation />
			<redirect view-id="/restricted/professor/TeachingExplore.xhtml">
				<message>Contenuto salvato correttamente</message>
			</redirect>
		</navigation>
		
		<!-- Qui potrei usare anche l'action che effettivamente uso in Elimina -->
		<navigation from-action="#{contentManager.delete}">
			<end-conversation />
			<redirect view-id="/restricted/professor/TeachingExplore.xhtml">
				<message>Contenuto eliminato correttamente</message>
			</redirect>
		</navigation>
	</page>
	
	
	
	
	<exception class="javax.ejb.EJBAccessException">
		<redirect view-id="/error.xhtml">
			<message severity="warn">Invalid User or caller unauthorized</message>
		</redirect>
	</exception>
	<exception class="org.jboss.seam.framework.EntityNotFoundException">
		<redirect view-id="/error.xhtml">
			<message severity="warn">Record not found</message>
		</redirect>
	</exception>
	<exception class="javax.persistence.EntityNotFoundException">
		<redirect view-id="/error.xhtml">
			<message severity="warn">Record not found</message>
		</redirect>
	</exception>
	<exception class="javax.persistence.EntityExistsException">
		<redirect view-id="/error.xhtml">
			<message severity="warn">Duplicate record</message>
		</redirect>
	</exception>
	<exception class="javax.persistence.OptimisticLockException">
		<end-conversation />
		<redirect view-id="/error.xhtml">
			<message severity="warn">Another user changed the same data, please try again</message>
		</redirect>
	</exception>
	<exception class="org.jboss.seam.security.AuthorizationException">
		<redirect view-id="/error.xhtml">
			<message severity="error">You don't have permission to access this resource</message>
		</redirect>
	</exception>
	<exception class="org.jboss.seam.security.NotLoggedInException">
		<redirect view-id="/login.xhtml">
			<message severity="warn">#{messages['org.jboss.seam.NotLoggedIn']}</message>
		</redirect>
	</exception>
	<exception class="javax.faces.application.ViewExpiredException">
		<redirect view-id="/error.xhtml">
			<message severity="warn">Your session has timed out, please try again</message>
		</redirect>
	</exception>
	<exception class="org.jboss.seam.ConcurrentRequestTimeoutException"
		log-level="trace">
		<http-error error-code="503" />
	</exception>
	<exception>
		<redirect view-id="/error.xhtml">
			<message severity="error">Unexpected error, please try again</message>
		</redirect>
	</exception>
</pages>
